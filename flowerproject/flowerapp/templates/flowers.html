{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloom Heaven ‚Äî Indoor & Outdoor Plants</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --cream:     #f8f5ef;
            --warm:      #ede8de;
            --brown:     #2e1f0f;
            --brown-mid: #5c3d1e;
            --green:     #1e4d2b;
            --green-hi:  #2a6b3c;
            --green-lo:  rgba(30,77,43,.1);
            --green-mid: rgba(30,77,43,.18);
            --gold:      #b5833a;
            --gold-lo:   rgba(181,131,58,.12);
            --text:      #1e1408;
            --muted:     #7a6248;
            --border:    rgba(46,31,15,.1);
            --white:     #ffffff;
            --radius:    12px;
            --shadow:    0 2px 16px rgba(46,31,15,.08);
            --shadow-lg: 0 8px 40px rgba(46,31,15,.14);
        }
        html { scroll-behavior: smooth; }
        body { background: var(--cream); color: var(--text); font-family: 'Jost', sans-serif; min-height: 100vh; }

        /* ‚îÄ‚îÄ Topbar ‚îÄ‚îÄ */
        .topbar {
            background: var(--green);
            color: rgba(255,255,255,.85);
            font-size: 12px;
            font-weight: 400;
            letter-spacing: .04em;
            padding: 8px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .topbar a { color: rgba(255,255,255,.85); text-decoration: none; }
        .topbar a:hover { color: #fff; }

        /* ‚îÄ‚îÄ Navbar ‚îÄ‚îÄ */
        nav {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 0 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 72px;
            box-shadow: 0 1px 0 var(--border);
        }
        .nav-brand { display: flex; align-items: center; gap: 12px; text-decoration: none; }
        .logo-mark {
            width: 40px; height: 40px; background: var(--green);
            border-radius: 10px; display: flex; align-items: center;
            justify-content: center; font-size: 20px;
        }
        .brand-text { display: flex; flex-direction: column; line-height: 1.1; }
        .brand-name { font-family: 'Cormorant Garamond', serif; font-size: 20px; font-weight: 600; color: var(--brown); }
        .brand-tagline { font-size: 10px; color: var(--muted); letter-spacing: .1em; text-transform: uppercase; }

        .nav-links { display: flex; align-items: center; gap: 4px; }
        .nav-links a {
            color: var(--muted); text-decoration: none; font-size: 14px; font-weight: 500;
            padding: 7px 16px; border-radius: 8px; transition: color .2s, background .2s;
        }
        .nav-links a:hover { color: var(--green); background: var(--green-lo); }

        .nav-actions { display: flex; align-items: center; gap: 10px; }

        /* Profile button */
        .profile-btn {
            background: var(--warm); border: 1px solid var(--border); border-radius: 50%;
            width: 38px; height: 38px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 16px; position: relative; transition: background .2s;
        }
        .profile-btn:hover { background: var(--border); }

        /* Profile dropdown */
        .profile-dropdown {
            background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
            box-shadow: var(--shadow-lg); min-width: 220px;
            opacity: 0; pointer-events: none; position: absolute;
            right: 0; top: calc(100% + 10px); transition: opacity .2s, transform .2s;
            transform: translateY(-6px); z-index: 300;
        }
        .profile-wrap { position: relative; }
        .profile-wrap.open .profile-dropdown { opacity: 1; pointer-events: all; transform: translateY(0); }

        .profile-header {
            padding: 16px 18px; border-bottom: 1px solid var(--border);
            display: flex; align-items: center; gap: 12px;
        }
        .profile-avatar {
            width: 40px; height: 40px; background: var(--green); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: #fff; font-size: 16px; font-weight: 600; flex-shrink: 0;
        }
        .profile-info h4 { font-size: 14px; font-weight: 600; color: var(--brown); }
        .profile-info p  { font-size: 12px; color: var(--muted); margin-top: 2px; }

        .profile-menu { padding: 8px; }
        .profile-menu a {
            display: flex; align-items: center; gap: 10px; padding: 9px 10px;
            border-radius: 8px; text-decoration: none; color: var(--brown-mid);
            font-size: 13px; font-weight: 500; transition: background .15s;
        }
        .profile-menu a:hover { background: var(--warm); color: var(--green); }
        .profile-menu .logout { color: #c0392b; }
        .profile-menu .logout:hover { background: #fef2f2; }
        .profile-divider { height: 1px; background: var(--border); margin: 4px 0; }

        .orders-btn {
            background: transparent; border: 1px solid var(--border); border-radius: 10px;
            color: var(--brown-mid); cursor: pointer; font-family: 'Jost', sans-serif;
            font-size: 13px; font-weight: 500; padding: 8px 16px; transition: border-color .2s, background .2s;
        }
        .orders-btn:hover { border-color: var(--green); color: var(--green); background: var(--green-lo); }

        .cart-btn {
            background: var(--green); border: none; border-radius: 10px; color: var(--white);
            cursor: pointer; font-family: 'Jost', sans-serif; font-size: 13px; font-weight: 500;
            padding: 9px 18px; display: flex; align-items: center; gap: 8px;
            transition: background .2s, transform .1s; position: relative;
        }
        .cart-btn:hover { background: var(--green-hi); }
        .cart-btn:active { transform: scale(.97); }
        .cart-count {
            background: var(--gold); border-radius: 50%; color: #fff; font-size: 10px; font-weight: 600;
            height: 18px; width: 18px; display: none; align-items: center; justify-content: center;
            position: absolute; top: -6px; right: -6px;
        }
        .cart-count.visible { display: flex; }

        /* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
        .hero {
            background: linear-gradient(150deg, #1a3d22 0%, #0d2414 60%, #1c3a1a 100%);
            padding: 80px 40px 70px;
            position: relative; overflow: hidden;
            display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: center;
            max-width: 100%;
        }
        .hero::before {
            content: ''; position: absolute; inset: 0;
            background: radial-gradient(ellipse at 70% 50%, rgba(30,77,43,.4) 0%, transparent 70%);
        }
        .hero::after {
            content: 'üåø'; position: absolute; right: -20px; bottom: -20px;
            font-size: 200px; opacity: .04; line-height: 1;
        }
        .hero-content { position: relative; z-index: 1; padding-left: 40px; }
        .hero-tag {
            background: rgba(181,131,58,.2); border: 1px solid rgba(181,131,58,.4);
            border-radius: 100px; color: #e8c07a; display: inline-flex; align-items: center; gap: 6px;
            font-size: 11px; font-weight: 500; letter-spacing: .1em;
            margin-bottom: 24px; padding: 5px 14px; text-transform: uppercase;
        }
        .hero-tag::before { content: '‚óè'; font-size: 6px; }
        .hero h2 {
            color: var(--white); font-family: 'Cormorant Garamond', serif;
            font-size: clamp(38px, 4vw, 58px); font-weight: 600; line-height: 1.15; margin-bottom: 18px;
        }
        .hero h2 em { font-style: italic; color: #8ecb9e; display: block; }
        .hero p { color: rgba(255,255,255,.65); font-size: 15px; line-height: 1.7; max-width: 420px; margin-bottom: 32px; }

        .hero-stats { display: flex; gap: 32px; }
        .hero-stat strong { display: block; font-size: 26px; font-weight: 600; color: #fff; font-family: 'Cormorant Garamond', serif; }
        .hero-stat span   { font-size: 11px; color: rgba(255,255,255,.5); text-transform: uppercase; letter-spacing: .08em; }

        .hero-visual { position: relative; z-index: 1; display: flex; justify-content: center; align-items: center; }
        .hero-plant-cards {
            display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 340px;
        }
        .hero-plant-card {
            background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.12);
            border-radius: 12px; padding: 16px; text-align: center; backdrop-filter: blur(8px);
        }
        .hero-plant-card .plant-emoji { font-size: 32px; display: block; margin-bottom: 8px; }
        .hero-plant-card .plant-name  { color: rgba(255,255,255,.9); font-size: 12px; font-weight: 500; }
        .hero-plant-card .plant-price { color: #8ecb9e; font-size: 13px; font-weight: 600; margin-top: 4px; }
        .hero-plant-card.featured { grid-column: 1 / -1; display: flex; align-items: center; gap: 16px; text-align: left; }
        .hero-plant-card.featured .plant-emoji { font-size: 44px; flex-shrink: 0; }

        /* ‚îÄ‚îÄ Category Pills ‚îÄ‚îÄ */
        .category-section { background: var(--white); border-bottom: 1px solid var(--border); padding: 16px 40px; }
        .cat-pills { display: flex; gap: 8px; overflow-x: auto; scrollbar-width: none; }
        .cat-pills::-webkit-scrollbar { display: none; }
        .cat-pill {
            background: var(--warm); border: 1px solid var(--border); border-radius: 100px;
            color: var(--muted); cursor: pointer; font-family: 'Jost', sans-serif; font-size: 13px;
            font-weight: 500; padding: 6px 16px; white-space: nowrap; transition: all .2s;
            flex-shrink: 0;
        }
        .cat-pill:hover, .cat-pill.active { background: var(--green); border-color: var(--green); color: #fff; }

        /* ‚îÄ‚îÄ Main ‚îÄ‚îÄ */
        .main { max-width: 1320px; margin: 0 auto; padding: 36px 24px 60px; }

        /* ‚îÄ‚îÄ Filters ‚îÄ‚îÄ */
        .filters-bar {
            background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
            padding: 14px 20px; display: flex; align-items: center; gap: 12px;
            flex-wrap: wrap; margin-bottom: 28px; box-shadow: var(--shadow);
        }
        .filter-label { font-size: 11px; font-weight: 600; color: var(--muted); letter-spacing: .08em; text-transform: uppercase; }
        .filter-select {
            background: var(--warm); border: 1px solid var(--border); border-radius: 8px;
            color: var(--text); font-family: 'Jost', sans-serif; font-size: 13px; font-weight: 500;
            padding: 7px 30px 7px 11px; outline: none; cursor: pointer; appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%237a6248' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 9px center; transition: border-color .2s;
        }
        .filter-select:focus { border-color: var(--green); }
        .results-info { margin-left: auto; font-size: 12px; color: var(--muted); }

        /* ‚îÄ‚îÄ Grid ‚îÄ‚îÄ */
        .flower-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; list-style: none; }
        .flower-card {
            background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden; display: flex; flex-direction: column; box-shadow: var(--shadow);
            transition: transform .25s, box-shadow .25s; animation: fadeUp .4s ease both;
        }
        .flower-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
        @keyframes fadeUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }

        .card-img-wrap { position: relative; height: 210px; overflow: hidden; background: var(--warm); }
        .card-img-wrap img { width: 100%; height: 100%; object-fit: cover; transition: transform .4s ease; }
        .flower-card:hover .card-img-wrap img { transform: scale(1.05); }

        .stock-badge {
            position: absolute; top: 10px; right: 10px; border-radius: 6px;
            font-size: 10px; font-weight: 600; letter-spacing: .04em; padding: 3px 8px; text-transform: uppercase;
        }
        .stock-in  { background: var(--green-lo); color: var(--green); border: 1px solid rgba(30,77,43,.2); }
        .stock-low { background: var(--gold-lo);  color: var(--gold);  border: 1px solid rgba(181,131,58,.25); }
        .stock-out { background: rgba(0,0,0,.05); color: var(--muted); border: 1px solid var(--border); }

        .card-category {
            position: absolute; bottom: 10px; left: 10px; background: rgba(255,255,255,.94);
            border-radius: 6px; font-size: 11px; font-weight: 500; color: var(--brown-mid); padding: 3px 8px;
        }

        .card-body { padding: 16px 18px; flex: 1; display: flex; flex-direction: column; }
        .card-body h3 { font-family: 'Cormorant Garamond', serif; font-size: 18px; font-weight: 600; color: var(--brown); margin-bottom: 6px; line-height: 1.25; }
        .card-body p {
            font-size: 13px; color: var(--muted); line-height: 1.55; flex: 1; margin-bottom: 14px;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }
        .price { font-size: 21px; font-weight: 600; color: var(--green); font-family: 'Cormorant Garamond', serif; }
        .price span { font-size: 12px; font-weight: 400; color: var(--muted); font-family: 'Jost', sans-serif; }

        .card-actions { display: flex; gap: 8px; margin-top: 14px; }
        .btn-cart {
            flex: 1; background: var(--green-lo); border: 1px solid rgba(30,77,43,.2); border-radius: 8px;
            color: var(--green); cursor: pointer; font-family: 'Jost', sans-serif; font-size: 13px;
            font-weight: 600; padding: 10px; transition: background .2s, transform .1s;
        }
        .btn-cart:hover { background: var(--green-mid); }
        .btn-cart:active { transform: scale(.97); }
        .btn-cart:disabled { opacity: .4; cursor: not-allowed; }
        .btn-buy {
            flex: 1; background: var(--green); border: none; border-radius: 8px; color: var(--white);
            cursor: pointer; font-family: 'Jost', sans-serif; font-size: 13px; font-weight: 600;
            padding: 10px; transition: background .2s, transform .1s;
        }
        .btn-buy:hover { background: var(--green-hi); }
        .btn-buy:active { transform: scale(.97); }
        .btn-buy:disabled { opacity: .4; cursor: not-allowed; }

        /* ‚îÄ‚îÄ Skeleton ‚îÄ‚îÄ */
        .skeleton-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
        .skel { background: linear-gradient(90deg, var(--warm) 25%, #e4ddd2 50%, var(--warm) 75%); background-size: 200% 100%; animation: shimmer 1.4s infinite; }
        .skel-img  { height: 210px; }
        .skel-body { padding: 16px 18px; }
        .skel-line { border-radius: 4px; margin-bottom: 10px; }
        .skel-line.title { height: 18px; width: 70%; }
        .skel-line.desc  { height: 13px; width: 100%; }
        .skel-line.desc2 { height: 13px; width: 55%; }
        .skel-line.price { height: 20px; width: 38%; margin-top: 14px; }
        .skel-btns { display: flex; gap: 8px; margin-top: 14px; }
        .skel-btn  { flex: 1; height: 38px; border-radius: 8px; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        /* ‚îÄ‚îÄ Pagination ‚îÄ‚îÄ */
        .pagination { display: flex; align-items: center; justify-content: center; gap: 12px; margin-top: 44px; }
        .page-btn {
            background: var(--white); border: 1px solid var(--border); border-radius: 10px;
            color: var(--brown-mid); cursor: pointer; font-family: 'Jost', sans-serif;
            font-size: 13px; font-weight: 500; padding: 10px 22px; transition: border-color .2s, background .2s, transform .1s;
        }
        .page-btn:hover:not(:disabled) { border-color: var(--green); color: var(--green); background: var(--green-lo); }
        .page-btn:active:not(:disabled) { transform: scale(.97); }
        .page-btn:disabled { opacity: .35; cursor: not-allowed; }
        .page-info { font-size: 13px; color: var(--muted); font-weight: 500; min-width: 100px; text-align: center; }

        /* ‚îÄ‚îÄ Empty ‚îÄ‚îÄ */
        .empty-state { text-align: center; padding: 80px 20px; grid-column: 1 / -1; }
        .empty-state .icon { font-size: 52px; margin-bottom: 16px; display: block; }
        .empty-state h3 { font-family: 'Cormorant Garamond', serif; font-size: 24px; color: var(--brown); margin-bottom: 8px; }
        .empty-state p { color: var(--muted); font-size: 14px; }

        /* ‚îÄ‚îÄ About Modal ‚îÄ‚îÄ */
        .modal-overlay {
            background: rgba(30,20,8,.6); inset: 0; opacity: 0; pointer-events: none;
            position: fixed; transition: opacity .3s; z-index: 400; backdrop-filter: blur(6px);
        }
        .modal-overlay.open { opacity: 1; pointer-events: all; }
        .modal {
            background: var(--white); border-radius: 16px; box-shadow: var(--shadow-lg);
            left: 50%; max-width: 560px; padding: 40px; position: fixed;
            top: 50%; transform: translate(-50%, -48%); transition: transform .3s;
            width: calc(100% - 48px); z-index: 401;
        }
        .modal-overlay.open .modal { transform: translate(-50%, -50%); }
        .modal-close {
            background: var(--warm); border: none; border-radius: 8px; color: var(--muted);
            cursor: pointer; font-size: 16px; padding: 6px 10px; position: absolute; right: 16px; top: 16px;
        }
        .modal h2 { font-family: 'Cormorant Garamond', serif; font-size: 28px; color: var(--brown); margin-bottom: 16px; }
        .modal p  { color: var(--muted); font-size: 14px; line-height: 1.75; margin-bottom: 12px; }

        /* ‚îÄ‚îÄ Contact Modal ‚îÄ‚îÄ */
        .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 20px; }
        .contact-card {
            background: var(--warm); border-radius: 10px; padding: 16px;
            display: flex; flex-direction: column; gap: 4px;
        }
        .contact-card .label { font-size: 10px; font-weight: 600; color: var(--muted); letter-spacing: .08em; text-transform: uppercase; }
        .contact-card .value { font-size: 14px; font-weight: 500; color: var(--brown); }
        .contact-card.full  { grid-column: 1 / -1; }

        /* ‚îÄ‚îÄ Overlay & Cart Drawer ‚îÄ‚îÄ */
        .overlay {
            background: rgba(30,20,8,.55); inset: 0; opacity: 0; pointer-events: none;
            position: fixed; transition: opacity .3s; z-index: 200; backdrop-filter: blur(4px);
        }
        .overlay.open { opacity: 1; pointer-events: all; }
        .cart-drawer {
            background: var(--white); bottom: 0; box-shadow: -8px 0 48px rgba(30,20,8,.16);
            display: flex; flex-direction: column; position: fixed; right: 0; top: 0;
            transform: translateX(100%); transition: transform .35s cubic-bezier(.4,0,.2,1);
            width: min(420px, 100vw); z-index: 201;
        }
        .cart-drawer.open { transform: translateX(0); }

        .drawer-header { align-items: center; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; padding: 20px 24px; }
        .drawer-header h2 { font-family: 'Cormorant Garamond', serif; font-size: 22px; color: var(--brown); }
        .drawer-close {
            background: var(--warm); border: none; border-radius: 8px; color: var(--muted);
            cursor: pointer; font-size: 18px; height: 36px; width: 36px;
            display: flex; align-items: center; justify-content: center; transition: background .2s;
        }
        .drawer-close:hover { background: var(--border); color: var(--brown); }
        .drawer-body { flex: 1; overflow-y: auto; padding: 20px 24px; }

        .cart-empty { text-align: center; padding: 60px 20px; color: var(--muted); }
        .cart-empty .icon { font-size: 44px; margin-bottom: 14px; display: block; }
        .cart-empty h3 { font-family: 'Cormorant Garamond', serif; font-size: 20px; color: var(--brown); margin-bottom: 8px; }
        .cart-empty p { font-size: 13px; }

        .cart-loading { text-align: center; padding: 40px; color: var(--muted); font-size: 13px; }
        .spinner-sm { width: 22px; height: 22px; border: 2px solid var(--border); border-top-color: var(--green); border-radius: 50%; display: inline-block; animation: spin .7s linear infinite; margin-bottom: 8px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .cart-item { align-items: flex-start; border-bottom: 1px solid var(--border); display: flex; gap: 14px; padding: 16px 0; }
        .cart-item img { border-radius: 8px; height: 64px; object-fit: cover; width: 64px; flex-shrink: 0; }
        .cart-item-info { flex: 1; min-width: 0; }
        .cart-item-info h4 { font-size: 14px; font-weight: 600; color: var(--brown); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 3px; }
        .cart-item-info .item-price { font-size: 14px; color: var(--green); font-weight: 600; font-family: 'Cormorant Garamond', serif; }

        .item-qty { display: flex; align-items: center; gap: 8px; margin-top: 10px; }
        .qty-btn {
            background: var(--warm); border: 1px solid var(--border); border-radius: 6px; color: var(--brown);
            cursor: pointer; font-size: 14px; font-weight: 600; height: 28px; width: 28px;
            display: flex; align-items: center; justify-content: center; transition: background .15s;
        }
        .qty-btn:hover { background: var(--border); }
        .qty-num { font-size: 14px; font-weight: 600; color: var(--brown); min-width: 22px; text-align: center; }
        .remove-btn { background: none; border: none; color: var(--muted); cursor: pointer; font-size: 16px; padding: 4px; transition: color .15s; flex-shrink: 0; margin-top: 2px; }
        .remove-btn:hover { color: #c0392b; }

        .drawer-footer { border-top: 1px solid var(--border); padding: 20px 24px; }
        .cart-total { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 16px; }
        .cart-total span { font-size: 13px; color: var(--muted); font-weight: 500; }
        .cart-total strong { font-size: 26px; font-weight: 600; color: var(--green); font-family: 'Cormorant Garamond', serif; }

        .checkout-btn {
            background: var(--green); border: none; border-radius: 10px; color: var(--white);
            cursor: pointer; font-family: 'Jost', sans-serif; font-size: 15px; font-weight: 600;
            padding: 14px; width: 100%; transition: background .2s, transform .1s; letter-spacing: .02em;
        }
        .checkout-btn:hover { background: var(--green-hi); }
        .checkout-btn:active { transform: scale(.98); }
        .checkout-btn:disabled { opacity: .5; cursor: not-allowed; }

        /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
        footer {
            background: var(--brown);
            color: rgba(255,255,255,.7);
            padding: 64px 40px 32px;
            margin-top: 80px;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1.5fr;
            gap: 48px;
            max-width: 1320px;
            margin: 0 auto 48px;
        }
        .footer-brand .brand-name {
            font-family: 'Cormorant Garamond', serif; font-size: 24px; font-weight: 600;
            color: #fff; margin-bottom: 12px; display: block;
        }
        .footer-brand p { font-size: 13px; line-height: 1.7; max-width: 280px; }
        .footer-brand .socials { display: flex; gap: 10px; margin-top: 20px; }
        .social-btn {
            background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.12);
            border-radius: 8px; color: rgba(255,255,255,.7); font-size: 14px; padding: 8px 12px;
            text-decoration: none; transition: background .2s;
        }
        .social-btn:hover { background: rgba(255,255,255,.16); color: #fff; }

        .footer-col h4 {
            color: #fff; font-size: 12px; font-weight: 600; letter-spacing: .1em;
            text-transform: uppercase; margin-bottom: 16px;
        }
        .footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
        .footer-col ul a { color: rgba(255,255,255,.6); text-decoration: none; font-size: 13px; transition: color .2s; }
        .footer-col ul a:hover { color: #fff; }

        .footer-contact { display: flex; flex-direction: column; gap: 12px; }
        .contact-row { display: flex; gap: 10px; align-items: flex-start; }
        .contact-row .icon { font-size: 14px; margin-top: 1px; flex-shrink: 0; }
        .contact-row .info { font-size: 13px; line-height: 1.55; }
        .contact-row .info strong { color: rgba(255,255,255,.9); display: block; }

        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,.08);
            padding-top: 24px; max-width: 1320px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 12px; color: rgba(255,255,255,.4);
        }
        .footer-bottom a { color: rgba(255,255,255,.4); text-decoration: none; }

        /* ‚îÄ‚îÄ Toast ‚îÄ‚îÄ */
        .toast-container { bottom: 24px; display: flex; flex-direction: column; gap: 8px; pointer-events: none; position: fixed; right: 24px; z-index: 999; }
        .toast {
            align-items: center; background: var(--brown); border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,.2); color: var(--white); display: flex;
            font-size: 13px; font-weight: 500; gap: 10px; padding: 12px 18px;
            animation: toastIn .3s ease both, toastOut .3s ease 2.7s both;
        }
        .toast.success .ti { color: #6ee7a0; }
        .toast.error   .ti { color: #fca5a5; }
        .toast.info    .ti { color: #93c5fd; }
        @keyframes toastIn  { from { opacity:0; transform:translateX(20px); } to { opacity:1; transform:translateX(0); } }
        @keyframes toastOut { from { opacity:1; transform:translateX(0); } to { opacity:0; transform:translateX(20px); } }

        @media (max-width: 900px) {
            .hero { grid-template-columns: 1fr; padding: 48px 24px; }
            .hero-visual { display: none; }
            .hero-content { padding-left: 0; }
            .footer-grid { grid-template-columns: 1fr 1fr; }
            nav { padding: 0 16px; }
            .topbar { padding: 6px 16px; font-size: 11px; }
            .main { padding: 24px 16px 48px; }
            .nav-links { display: none; }
        }
        @media (max-width: 560px) {
            .footer-grid { grid-template-columns: 1fr; gap: 32px; }
            .category-section { padding: 12px 16px; }
        }
    </style>
</head>
<body>

<!-- Topbar -->
<div class="topbar">
    <span>üå± Free delivery on orders above ‚Çπ999</span>
    <span>üìû <a href="tel:8848622015">+91 88486 22015</a></span>
</div>

<!-- Navbar -->
<nav>
    <a href="#" class="nav-brand">
        <div class="logo-mark">üåø</div>
        <div class="brand-text">
            <span class="brand-name">Bloom Heaven</span>
            <span class="brand-tagline">Indoor & Outdoor Plants</span>
        </div>
    </a>
    <div class="nav-links">
        <a href="#" onclick="openAbout(event)">About</a>
        <a href="#" onclick="openContact(event)">Contact</a>
    </div>
    <div class="nav-actions">
        <button class="orders-btn" onclick="window.location.href='/orders/'">My Orders</button>

        <!-- Cart -->
        <button class="cart-btn" id="cartToggle">
            üõí Cart
            <span class="cart-count" id="cartCount">0</span>
        </button>

        <!-- Profile -->
        <div class="profile-wrap" id="profileWrap">
            <button class="profile-btn" id="profileBtn" title="My Profile">üë§</button>
            <div class="profile-dropdown" id="profileDropdown">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">?</div>
                    <div class="profile-info">
                        <h4 id="profileName">Loading‚Ä¶</h4>
                        <p id="profileEmail">‚Äî</p>
                    </div>
                </div>
                <div class="profile-menu">
                    <a href="/orders/">üì¶ My Orders</a>
                    <a href="#">‚öôÔ∏è Settings</a>
                    <div class="profile-divider"></div>
                    <a href="#" class="logout" onclick="logout(event)">üö™ Sign Out</a>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Hero -->
<div class="hero">
    <div class="hero-content">
        <span class="hero-tag">Kerala's Finest Plant Store</span>
        <h2>Bring nature<br><em>into your space</em></h2>
        <p>Handpicked indoor & outdoor plants delivered fresh to your door. From serene succulents to lush tropical greens ‚Äî find your perfect plant companion.</p>
        <div class="hero-stats">
            <div class="hero-stat"><strong>200+</strong><span>Plant varieties</span></div>
            <div class="hero-stat"><strong>500+</strong><span>Happy customers</span></div>
            <div class="hero-stat"><strong>2‚Äì3 day</strong><span>Delivery</span></div>
        </div>
    </div>
    <div class="hero-visual">
        <div class="hero-plant-cards">
            <div class="hero-plant-card featured">
                <span class="plant-emoji">üå¥</span>
                <div>
                    <div class="plant-name">Areca Palm</div>
                    <div class="plant-price">Most Popular</div>
                </div>
            </div>
            <div class="hero-plant-card">
                <span class="plant-emoji">ü™¥</span>
                <div class="plant-name">Money Plant</div>
                <div class="plant-price">Indoor</div>
            </div>
            <div class="hero-plant-card">
                <span class="plant-emoji">üåµ</span>
                <div class="plant-name">Cactus</div>
                <div class="plant-price">Low Care</div>
            </div>
            <div class="hero-plant-card">
                <span class="plant-emoji">üå∏</span>
                <div class="plant-name">Hibiscus</div>
                <div class="plant-price">Outdoor</div>
            </div>
            <div class="hero-plant-card">
                <span class="plant-emoji">üåø</span>
                <div class="plant-name">Peace Lily</div>
                <div class="plant-price">Air Purifier</div>
            </div>
        </div>
    </div>
</div>

<!-- Category Pills -->
<div class="category-section">
    <div class="cat-pills" id="catPills">
        <button class="cat-pill active" data-cat="">All Plants</button>
        {% for cat in categories %}
        <button class="cat-pill" data-cat="{{ cat.id }}">{{ cat.name }}</button>
        {% endfor %}
    </div>
</div>

<!-- Main -->
<div class="main">
    <div class="filters-bar">
        <span class="filter-label">Filter</span>
        <select class="filter-select" id="categoryFilter">
            <option value="">All Categories</option>
            {% for cat in categories %}
            <option value="{{ cat.id }}">{{ cat.name }}</option>
            {% endfor %}
        </select>
        <select class="filter-select" id="priceFilter">
            <option value="">All Prices</option>
            <option value="0-100">Under ‚Çπ100</option>
            <option value="101-500">‚Çπ101 ‚Äì ‚Çπ500</option>
            <option value="501-1000">‚Çπ501 ‚Äì ‚Çπ1000</option>
            <option value="1001-5000">‚Çπ1001+</option>
        </select>
        <span class="results-info" id="resultsInfo">Loading‚Ä¶</span>
    </div>

    <ul class="flower-grid" id="flowerGrid"></ul>

    <div class="pagination">
        <button class="page-btn" id="prevBtn" disabled>‚Üê Previous</button>
        <span class="page-info" id="pageInfo">‚Äî</span>
        <button class="page-btn" id="nextBtn" disabled>Next ‚Üí</button>
    </div>
</div>

<!-- Footer -->
<footer>
    <div class="footer-grid">
        <div class="footer-brand">
            <span class="brand-name">üåø Bloom Heaven</span>
            <p>Kerala's trusted source for premium indoor and outdoor plants. We bring nature closer to your home with carefully curated plants and same-week delivery.</p>
            <div class="socials">
                <a class="social-btn" href="#">üìò Facebook</a>
                <a class="social-btn" href="#">üì∏ Instagram</a>
                <a class="social-btn" href="#">üí¨ WhatsApp</a>
            </div>
        </div>
        <div class="footer-col">
            <h4>Shop</h4>
            <ul>
                <li><a href="#">Indoor Plants</a></li>
                <li><a href="#">Outdoor Plants</a></li>
                <li><a href="#">Succulents</a></li>
                <li><a href="#">Garden Plants</a></li>
                <li><a href="#">Rare Plants</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h4>Help</h4>
            <ul>
                <li><a href="#">Plant Care Guide</a></li>
                <li><a href="#">Shipping Policy</a></li>
                <li><a href="#">Returns</a></li>
                <li><a href="#" onclick="openAbout(event)">About Us</a></li>
                <li><a href="#" onclick="openContact(event)">Contact</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h4>Contact Us</h4>
            <div class="footer-contact">
                <div class="contact-row">
                    <span class="icon">üë§</span>
                    <div class="info"><strong>Harish Santhosh Kumar</strong>Bloom Heaven</div>
                </div>
                <div class="contact-row">
                    <span class="icon">üìç</span>
                    <div class="info">Kottinattu House, Thirumala Bhagom PO<br>Thuravoor, Cherthala, Alappuzha<br>Kerala ‚Äî 688 540</div>
                </div>
                <div class="contact-row">
                    <span class="icon">üìû</span>
                    <div class="info"><a href="tel:8848622015" style="color:rgba(255,255,255,.7);text-decoration:none">+91 88486 22015</a></div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <span>¬© 2026 Bloom Heaven. All rights reserved.</span>
        <span>Made with üåø in Kerala, India</span>
    </div>
</footer>

<!-- About Modal -->
<div class="modal-overlay" id="aboutOverlay">
    <div class="modal">
        <button class="modal-close" onclick="closeAbout()">‚úï</button>
        <h2>About Bloom Heaven</h2>
        <p>Bloom Heaven was founded with a simple belief ‚Äî every home deserves the beauty and calm that plants bring. Based in Thuravoor, Alappuzha, Kerala, we source and deliver the finest indoor and outdoor plants to homes across the region.</p>
        <p>From air-purifying indoor plants to vibrant garden varieties, every plant in our collection is handpicked for quality. We believe in sustainable, eco-friendly practices and take pride in packaging each plant with care so it arrives healthy and ready to thrive.</p>
        <p>Whether you're a first-time plant parent or a seasoned gardener, we're here to help you find the perfect plant for your space ‚Äî and guide you in caring for it.</p>
    </div>
</div>

<!-- Contact Modal -->
<div class="modal-overlay" id="contactOverlay">
    <div class="modal">
        <button class="modal-close" onclick="closeContact()">‚úï</button>
        <h2>Get in Touch</h2>
        <p>We'd love to hear from you. Reach out for orders, plant advice, or anything else.</p>
        <div class="contact-grid">
            <div class="contact-card full">
                <span class="label">Owner</span>
                <span class="value">Harish Santhosh Kumar</span>
            </div>
            <div class="contact-card full">
                <span class="label">Address</span>
                <span class="value">Kottinattu House, Thirumala Bhagom PO, Thuravoor, Cherthala, Alappuzha, Kerala ‚Äî 688 540</span>
            </div>
            <div class="contact-card">
                <span class="label">Phone</span>
                <span class="value"><a href="tel:8848622015" style="color:var(--brown);text-decoration:none">+91 88486 22015</a></span>
            </div>
            <div class="contact-card">
                <span class="label">Delivery</span>
                <span class="value">2‚Äì3 Business Days</span>
            </div>
        </div>
    </div>
</div>

<!-- Cart Overlay & Drawer -->
<div class="overlay" id="overlay"></div>
<div class="cart-drawer" id="cartDrawer">
    <div class="drawer-header">
        <h2>Your Cart</h2>
        <button class="drawer-close" id="cartClose">‚úï</button>
    </div>
    <div class="drawer-body" id="cartBody"></div>
    <div class="drawer-footer">
        <div class="cart-total">
            <span>Total</span>
            <strong id="cartTotal">‚Çπ0.00</strong>
        </div>
        <button class="checkout-btn" id="checkoutBtn" disabled>Place Order</button>
    </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script>
    const API_BASE   = 'http://127.0.0.1:8000/flowerapp';
    const PLACEHOLDER = [
        '/media/flowers/IMG20250917130730.jpg',
        '/media/flowers/IMG20251120162642.jpg',
        '/media/flowers/IMG20251120162648.jpg',
        '/media/flowers/IMG20251120162658.jpg',
        '/media/flowers/IMG20251120162704.jpg',
        '/media/flowers/IMG20251120162950.jpg',
    ];

    let currentPage = 1, totalPages = 1;
    let filters = { category: '', price: '' };

    // ‚îÄ‚îÄ Auth ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function refreshAccessToken() {
        const refresh = localStorage.getItem('refresh_token');
        if (!refresh) { window.location.href = '/signin/'; throw new Error('no refresh'); }
        const res = await fetch('http://127.0.0.1:8000/api/token/refresh/', {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ refresh })
        });
        if (!res.ok) { localStorage.clear(); window.location.href = '/signin/'; throw new Error('expired'); }
        localStorage.setItem('access_token', (await res.json()).access);
    }
    function getHeaders() {
        return { 'Content-Type': 'application/json', 'Authorization': `Bearer ${localStorage.getItem('access_token')}` };
    }
    async function authFetch(url, opts = {}) {
        opts.headers = getHeaders();
        let res = await fetch(url, opts);
        if (res.status === 401) { await refreshAccessToken(); opts.headers = getHeaders(); res = await fetch(url, opts); }
        return res;
    }
    function logout(e) {
        e.preventDefault();
        localStorage.clear();
        window.location.href = '/signin/';
    }

    // ‚îÄ‚îÄ Profile ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function loadProfile() {
        try {
            const res  = await authFetch(`${API_BASE}/api/me/`);
            const data = await res.json();
            const name = data.username || data.first_name || 'User';
            document.getElementById('profileName').textContent  = name;
            document.getElementById('profileEmail').textContent = data.email || '‚Äî';
            document.getElementById('profileAvatar').textContent = name.charAt(0).toUpperCase();
        } catch (e) { console.error('profile load failed'); }
    }
    document.getElementById('profileBtn').addEventListener('click', () => {
        document.getElementById('profileWrap').classList.toggle('open');
    });
    document.addEventListener('click', e => {
        if (!document.getElementById('profileWrap').contains(e.target))
            document.getElementById('profileWrap').classList.remove('open');
    });

    // ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function showToast(msg, type = 'success') {
        const icons = { success: '‚úì', error: '‚úï', info: '‚Ñπ' };
        const t = document.createElement('div');
        t.className = `toast ${type}`;
        t.innerHTML = `<span class="ti">${icons[type]}</span>${msg}`;
        document.getElementById('toastContainer').appendChild(t);
        setTimeout(() => t.remove(), 3100);
    }

    // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function resolveImage(item) {
        const img = item.flower_image || item.image;
        if (img) return img.startsWith('/') ? `${window.location.origin}${img}` : img;
        return PLACEHOLDER[Math.abs(item.id || 0) % PLACEHOLDER.length];
    }
    function stockBadge(flower) {
        const s = flower.stock ?? 999;
        if (s === 0) return { cls: 'stock-out', label: 'Out of Stock' };
        if (s <= 10) return { cls: 'stock-low', label: `Only ${s} left` };
        return { cls: 'stock-in', label: 'In Stock' };
    }

    // ‚îÄ‚îÄ Skeletons ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderSkeletons(n = 8) {
        document.getElementById('flowerGrid').innerHTML = Array(n).fill(`
            <li class="skeleton-card">
                <div class="skel skel-img"></div>
                <div class="skel-body">
                    <div class="skel skel-line title"></div>
                    <div class="skel skel-line desc"></div>
                    <div class="skel skel-line desc2"></div>
                    <div class="skel skel-line price"></div>
                    <div class="skel-btns"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div>
                </div>
            </li>`).join('');
    }

    // ‚îÄ‚îÄ Flowers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function fetchFlowers(page = 1) {
        currentPage = page;
        renderSkeletons();
        const url = new URL(`${API_BASE}/api/v1/flowers/`);
        url.searchParams.set('page', page);
        if (filters.category) url.searchParams.set('category', filters.category);
        if (filters.price)    url.searchParams.set('price', filters.price);
        try {
            const res  = await authFetch(url.toString());
            if (!res.ok) throw new Error();
            const data = await res.json();
            const flowers = Array.isArray(data) ? data : (data.results || []);
            const total   = data.count ?? flowers.length;
            totalPages    = Math.max(1, Math.ceil(total / (flowers.length || 10)));
            document.getElementById('resultsInfo').textContent = `${total} plant${total !== 1 ? 's' : ''} available`;
            renderFlowers(flowers);
            updatePagination(data.previous, data.next);
        } catch (e) { showToast('Failed to load plants', 'error'); }
    }

    function renderFlowers(flowers) {
        const grid = document.getElementById('flowerGrid');
        grid.innerHTML = '';
        if (!flowers.length) {
            grid.innerHTML = `<li class="empty-state"><span class="icon">üåæ</span><h3>No plants found</h3><p>Try adjusting your filters</p></li>`;
            return;
        }
        flowers.forEach((flower, idx) => {
            const badge = stockBadge(flower);
            const out   = (flower.stock ?? 999) === 0;
            const li    = document.createElement('li');
            li.className = 'flower-card';
            li.style.animationDelay = `${idx * 0.05}s`;
            li.innerHTML = `
                <div class="card-img-wrap">
                    <img src="${resolveImage(flower)}" alt="${flower.name}" loading="lazy">
                    <span class="stock-badge ${badge.cls}">${badge.label}</span>
                    ${flower.category_name ? `<span class="card-category">${flower.category_name}</span>` : ''}
                </div>
                <div class="card-body">
                    <h3>${flower.name}</h3>
                    <p>${flower.description || 'A beautiful plant for your home or garden.'}</p>
                    <div class="price">‚Çπ${parseFloat(flower.price).toFixed(2)} <span>/ plant</span></div>
                    <div class="card-actions">
                        <button class="btn-cart" ${out ? 'disabled' : ''}>üõí Add to Cart</button>
                        <button class="btn-buy"  ${out ? 'disabled' : ''}>Buy Now</button>
                    </div>
                </div>`;
            li.querySelector('.btn-cart').addEventListener('click', () => addToCart(flower));
            li.querySelector('.btn-buy').addEventListener('click',  () => buyNow(flower));
            grid.appendChild(li);
        });
    }

    function updatePagination(prev, next) {
        document.getElementById('prevBtn').disabled = !prev;
        document.getElementById('nextBtn').disabled = !next;
        document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
    }

    // ‚îÄ‚îÄ Cart API ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function fetchCart() {
        try {
            const res   = await authFetch(`${API_BASE}/api/v1/cart/`);
            const data  = await res.json();
            const items = data.items || [];
            const qty   = items.reduce((s, i) => s + i.quantity, 0);
            const countEl = document.getElementById('cartCount');
            countEl.textContent = qty;
            // only show badge if items > 0
            qty > 0 ? countEl.classList.add('visible') : countEl.classList.remove('visible');
            document.getElementById('cartTotal').textContent = `‚Çπ${parseFloat(data.grand_total || 0).toFixed(2)}`;
            document.getElementById('checkoutBtn').disabled  = items.length === 0;
            if (document.getElementById('cartDrawer').classList.contains('open')) renderCartDrawer(items);
        } catch (e) { console.error('cart fetch failed'); }
    }

    async function addToCart(flower) {
        try {
            const res  = await authFetch(`${API_BASE}/api/v1/cart/`, {
                method: 'POST', body: JSON.stringify({ flower_id: flower.id, quantity: 1 })
            });
            const data = await res.json();
            if (res.ok) { await fetchCart(); showToast(`${flower.name} added to cart üåø`, 'success'); }
            else showToast(data.error || 'Failed to add', 'error');
        } catch (e) { showToast('Network error', 'error'); }
    }

    async function updateQty(itemId, newQty) {
        if (newQty <= 0) { await removeFromCart(itemId); return; }
        try {
            await authFetch(`${API_BASE}/api/v1/cart/${itemId}/`, {
                method: 'PATCH', body: JSON.stringify({ quantity: newQty })
            });
            await fetchCart();
        } catch (e) { showToast('Failed to update', 'error'); }
    }

    async function removeFromCart(itemId) {
        try {
            await authFetch(`${API_BASE}/api/v1/cart/${itemId}/`, { method: 'DELETE' });
            await fetchCart();
        } catch (e) { showToast('Failed to remove', 'error'); }
    }

    // ‚îÄ‚îÄ Cart Drawer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderCartDrawer(items = []) {
        const body = document.getElementById('cartBody');
        if (!items.length) {
            body.innerHTML = `
                <div class="cart-empty">
                    <span class="icon">üå±</span>
                    <h3>Your cart is empty</h3>
                    <p>Add some beautiful plants to get started!</p>
                </div>`;
            return;
        }
        body.innerHTML = '';
        items.forEach(item => {
            const imgSrc = item.flower_image
                ? (item.flower_image.startsWith('/') ? `${window.location.origin}${item.flower_image}` : item.flower_image)
                : PLACEHOLDER[0];
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `
                <img src="${imgSrc}" alt="${item.flower_name}">
                <div class="cart-item-info">
                    <h4>${item.flower_name}</h4>
                    <div class="item-price">‚Çπ${parseFloat(item.total_price).toFixed(2)}</div>
                    <div class="item-qty">
                        <button class="qty-btn" data-id="${item.id}" data-qty="${item.quantity - 1}">‚àí</button>
                        <span class="qty-num">${item.quantity}</span>
                        <button class="qty-btn" data-id="${item.id}" data-qty="${item.quantity + 1}">+</button>
                    </div>
                </div>
                <button class="remove-btn" data-id="${item.id}">‚úï</button>`;
            div.querySelectorAll('.qty-btn').forEach(b =>
                b.addEventListener('click', () => updateQty(b.dataset.id, parseInt(b.dataset.qty)))
            );
            div.querySelector('.remove-btn').addEventListener('click', () => removeFromCart(item.id));
            body.appendChild(div);
        });
    }

    function openCart() {
        document.getElementById('cartBody').innerHTML = `<div class="cart-loading"><div class="spinner-sm"></div><br>Loading cart‚Ä¶</div>`;
        document.getElementById('cartDrawer').classList.add('open');
        document.getElementById('overlay').classList.add('open');
        document.body.style.overflow = 'hidden';
        authFetch(`${API_BASE}/api/v1/cart/`).then(r => r.json()).then(d => renderCartDrawer(d.items || []));
    }

    function closeCart() {
        document.getElementById('cartDrawer').classList.remove('open');
        document.getElementById('overlay').classList.remove('open');
        document.body.style.overflow = '';
    }

    // ‚îÄ‚îÄ Buy Now ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function buyNow(flower) {
        try {
            const res  = await authFetch(`${API_BASE}/api/buy-now/`, {
                method: 'POST', body: JSON.stringify({ flowers: [flower.id] })
            });
            const data = await res.json();
            res.ok ? showToast(`Order #${data.order_id} placed! üéâ`, 'success')
                   : showToast(data.error || 'Failed', 'error');
        } catch (e) { showToast('Network error', 'error'); }
    }

    // ‚îÄ‚îÄ Checkout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function checkout() {
        const btn = document.getElementById('checkoutBtn');
        btn.disabled = true; btn.textContent = 'Placing Order‚Ä¶';
        try {
            const cartData = await (await authFetch(`${API_BASE}/api/v1/cart/`)).json();
            const items    = cartData.items || [];
            if (!items.length) { showToast('Cart is empty', 'error'); return; }
            const flowerIds = items.flatMap(i => Array(i.quantity).fill(i.flower));
            const res  = await authFetch(`${API_BASE}/api/buy-now/`, {
                method: 'POST', body: JSON.stringify({ flowers: flowerIds })
            });
            const data = await res.json();
            if (res.ok) {
                closeCart(); await fetchCart();
                showToast(`Order #${data.order_id} placed! üéâ`, 'success');
            } else showToast(data.error || 'Checkout failed', 'error');
        } catch (e) { showToast('Network error', 'error'); }
        finally { btn.disabled = false; btn.textContent = 'Place Order'; }
    }

    // ‚îÄ‚îÄ Modals ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function openAbout(e)   { e.preventDefault(); document.getElementById('aboutOverlay').classList.add('open'); }
    function closeAbout()   { document.getElementById('aboutOverlay').classList.remove('open'); }
    function openContact(e) { e.preventDefault(); document.getElementById('contactOverlay').classList.add('open'); }
    function closeContact() { document.getElementById('contactOverlay').classList.remove('open'); }

    document.getElementById('aboutOverlay').addEventListener('click', e => {
        if (e.target === e.currentTarget) closeAbout();
    });
    document.getElementById('contactOverlay').addEventListener('click', e => {
        if (e.target === e.currentTarget) closeContact();
    });

    // ‚îÄ‚îÄ Category pills ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('.cat-pill').forEach(pill => {
        pill.addEventListener('click', () => {
            document.querySelectorAll('.cat-pill').forEach(p => p.classList.remove('active'));
            pill.classList.add('active');
            filters.category = pill.dataset.cat;
            document.getElementById('categoryFilter').value = pill.dataset.cat;
            fetchFlowers(1);
        });
    });

    // ‚îÄ‚îÄ Events ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.getElementById('cartToggle').addEventListener('click', openCart);
    document.getElementById('cartClose').addEventListener('click', closeCart);
    document.getElementById('overlay').addEventListener('click', closeCart);
    document.getElementById('checkoutBtn').addEventListener('click', checkout);

    document.getElementById('categoryFilter').addEventListener('change', e => {
        filters.category = e.target.value;
        document.querySelectorAll('.cat-pill').forEach(p => {
            p.classList.toggle('active', p.dataset.cat === e.target.value);
        });
        fetchFlowers(1);
    });
    document.getElementById('priceFilter').addEventListener('change', e => {
        filters.price = e.target.value; fetchFlowers(1);
    });
    document.getElementById('prevBtn').addEventListener('click', () => { if (currentPage > 1) fetchFlowers(currentPage - 1); });
    document.getElementById('nextBtn').addEventListener('click', () => fetchFlowers(currentPage + 1));

    // ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    fetchFlowers(1);
    fetchCart();
    loadProfile();
</script>
</body>
</html>